<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flip Cards - Updated with Data Patterns</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/styles-cards-patterns-002.css">
    <link rel="stylesheet" href="assets/css/styles-modal.css">
</head>
<body>

<h4 class="text-shadow">Quick Links Dashboard</h4>
<div class="flip-container">

<!-- DESIGN CARD -->
<div class="flip" data-pattern="sky">
    <div class="front">
        <h1 class="text-shadow">DESIGN</h1>
        <p>Color Palettes â€¢ Stock Assets â€¢ Fonts</p>
    </div>
    <div class="back back-three-columns layout-grid">
        <div class="columns-wrapper">
            <div class="column">
                <h3>Stock Assets</h3>
                <div class="link-item"><a href="https://stock.adobe.com/" target="_blank">ğŸ–¼ï¸ Adobe Stock</a></div>
                <div class="link-item"><a href="https://emojicopy.com/" target="_blank">ğŸ™‚ Emojis</a></div>
                <div class="link-item"><a href="https://www.svgrepo.com/" target="_blank">ğŸ“· SVG Repo</a></div>
                <div class="link-item"><a href="https://www.reshot.com/free-svg-icons/" target="_blank">ğŸ¯ Reshot (Icons)</a></div>
            </div>
            <div class="column">
                <h3>Asset Creation</h3>
                <div class="link-item"><a href="https://beefree.io/app/590652/572321/projects" target="_blank">ğŸ BeeFree Pro</a></div>
                <div class="link-item"><a href="https://auth.creatopy.com/auth/realms/creatopy/protocol/openid-connect/auth" target="_blank">ğŸ¨ Creatopy</a></div>
                <div class="link-item"><a href="https://generator.goldcocreatives.com/generate" target="_blank">âš¡ Generator v1</a></div>
                <div class="link-item"><a href="https://adamismyusername.github.io/4in1/" target="_blank">ğŸ”„ Generator 4in1</a></div>
            </div>
            <div class="column">
                <h3>Colors</h3>
                <div class="link-item"><a href="https://tailwindcolor.com/" target="_blank">ğŸ¨ Tailwind v4</a></div>
                <div class="link-item"><a href="https://materialui.co/flatuicolors" target="_blank">ğŸ­ Flat UI</a></div>
                <div class="link-item"><a href="https://materialui.co/colors" target="_blank">ğŸ¯ Material</a></div>
                <div class="link-item"><a href="https://maketintsandshades.com/" target="_blank">ğŸŒˆ Tint & Shades</a></div>
            </div>
        </div>
    </div>
</div>

<!-- DEVELOPMENT CARD -->
<div class="flip" data-pattern="pink">
    <div class="front">
        <h1 class="text-shadow">DEVELOPMENT</h1>
        <p>Github â€¢ Servers â€¢ APIs â€¢ Libraries</p>
    </div>
    <div class="back back-three-columns layout-grid">
        <div class="columns-wrapper">
            <div class="column">
                <h3>Automation & Tools</h3>
                <div class="link-item" data-modal-id="github"><a href="https://github.com/adamismyusername" target="_blank">ğŸ™ GitHub</a></div>
                <div class="link-item"><a href="https://zapier.com/app/assets/zaps" target="_blank">âš¡ Zapier</a></div>
                <div class="link-item"><a href="https://webscraping.ai/" target="_blank">ğŸ•·ï¸ WebScraping.io</a></div>
            </div>
            <div class="column">
                <h3>Unbounce</h3>
                <div class="link-item"><a href="https://app.unbounce.com/5598866/pages" target="_blank">ğŸš€ Unbounce</a></div>
                <div class="link-item"><a href="https://app.unbounce.com/4965941/pages/8e32c647-2fd7-4652-94c9-945e25d5c511/overview" target="_blank">ğŸ¬ Video Header</a></div>
                <div class="link-item"><a href="https://app.unbounce.com/5598866/pages/240566c7-1f64-4bed-aa22-f496f6cd6212/overview" target="_blank">ğŸ’£ Elon Debt Bomb</a></div>
            </div>
            <div class="column">
                <h3>MCPs</h3>
                <div class="link-item"><a href="https://github.com/microsoft/playwright-mcp" target="_blank">ğŸ”Œ Playwright</a></div>
            </div>
        </div>
    </div>
</div>

<!-- AI CARD -->
<div class="flip" data-pattern="purple">
    <div class="front">
        <h1 class="text-shadow">AI</h1>
        <p>LLMs â€¢ MCPs â€¢ Agent â€¢ Misc Resources</p>
    </div>
    <div class="back back-three-columns layout-grid">
        <div class="columns-wrapper">
            <div class="column">
                <h3>LLMs</h3>
                <div class="link-item"><a href="https://claude.ai/new" target="_blank">ğŸ¤– Claude</a></div>
                <div class="link-item"><a href="https://chatgpt.com/" target="_blank">ğŸ’¬ Chat GPT</a></div>
                <div class="link-item"><a href="https://grok.com/" target="_blank">ğŸ”® Grok</a></div>
                <div class="link-item"><a href="https://app.affogato.ai/" target="_blank">â˜• Affogato</a></div>
            </div>
            <div class="column">
                <h3>AI Agents</h3>
                <div class="link-item"><a href="https://n8n.srv1017071.hstgr.cloud/home/workflows" target="_blank">ğŸ”— N8N</a></div>
            </div>
            <div class="column">
                <h3>Misc Resources</h3>
                <div class="link-item"><a href="https://docs.google.com/document/d/1tGc1KehX-Y8tUWFoMzRJmZXfjbbx-3v2dIEYhy2g2vk/edit?tab=t.0" target="_blank">ğŸ—ï¸ Building Agents</a></div>
            </div>
        </div>
    </div>
</div>

<!-- INSPIRATION CARD -->
<div class="flip" data-pattern="indigo">
    <div class="front">
        <h1 class="text-shadow">INSPIRATION</h1>
    </div>
    <div class="back back-three-columns layout-grid">
        <div class="columns-wrapper">
            <div class="column">
                <h3>Design Galleries</h3>
                <div class="link-item"><a href="https://land-book.com/" target="_blank">ğŸï¸ Landbook</a></div>
            </div>
            <div class="column">
                <h3>Column 2</h3>
            </div>
            <div class="column">
                <h3>Column 3</h3>
            </div>
        </div>
    </div>
</div>

<!-- SALES CARD -->
<div class="flip" data-pattern="green">
    <div class="front">
        <h1 class="text-shadow">SALES</h1>
    </div>
    <div class="back back-three-columns layout-grid">
        <div class="columns-wrapper">
            <div class="column">
                <h3>Leads & Campaigns</h3>
                <div class="link-item"><a href="https://goldco.my.salesforce.com/home/home.jsp" target="_blank">â˜ï¸ Salesforce</a></div>
                <div class="link-item"><a href="https://goldco.everflowclient.io/" target="_blank">ğŸŒŠ Everflow</a></div>
            </div>
            <div class="column">
                <h3>Tracking & Reports</h3>
                <div class="link-item"><a href="https://docs.google.com/spreadsheets/d/1fpGm_ZezuaGa2iI9PCkc_Y1WLpNl7XCjSA8Z4H0TGcU/edit?gid=0#gid=0" target="_blank">ğŸŒ§ï¸ Rainmaker</a></div>
                <div class="link-item"><a href="https://docs.google.com/spreadsheets/d/1UTGdgonpAwiHKYQ5B9N3zj25DXrRpk4I7zcHmlPuXtk/edit?gid=895709536#gid=895709536" target="_blank">ğŸ¨ Creatives</a></div>
                <div class="link-item"><a href="https://docs.google.com/spreadsheets/d/16HWgzDICOlN6cz5MUsRMfL6epiuuQIKQ/edit?gid=1192968110#gid=1192968110" target="_blank">ğŸ“ˆ A2M Bookings</a></div>
                <div class="link-item"><a href="https://docs.google.com/spreadsheets/d/1Uo0MmoYlr6KBwa5vN2q0stcFLXsNcnhpfrJ0XR8hg2k/edit?gid=550976728#gid=550976728" target="_blank">ğŸ“Š IMS Bookings</a></div>
            </div>
            <div class="column">
                <h3>Misc Tools</h3>
                <div class="link-item"><a href="https://www.pollfish.com/dashboard/surveys/" target="_blank">ğŸ  PollFish</a></div>
                <div class="link-item"><a href="https://temp-number.com/countries/United-States" target="_blank">ğŸ“± Temp Phone #</a></div>
                <div class="link-item"><a href="https://www.lambdatest.com/responsive-test-online" target="_blank">ğŸ“± Responsive Test</a></div>
            </div>
        </div>
    </div>
</div>

<!-- MARKETING CARD -->
<div class="flip" data-pattern="orange">
    <div class="front">
        <h1 class="text-shadow">MARKETING</h1>
    </div>
    <div class="back back-three-columns layout-grid">
        <div class="columns-wrapper">
            <div class="column">
                <h3>Budget & Planning</h3>
                <div class="link-item"><a href="https://goldco-force.monday.com/overviews/30365721" target="_blank">ğŸ’° Budget</a></div>
            </div>
            <div class="column">
                <h3>Campaign Tools</h3>
                <div class="link-item"><a href="https://mck3qzddmyzrqj4h3nxgbgq76y90.login.exacttarget.com/hub-cas/login" target="_blank">â˜ï¸ SFMC</a></div>
                <div class="link-item"><a href="https://kap-tool-campaign-name-generator.tiiny.site/" target="_blank">ğŸ·ï¸ Name Tool</a></div>
                <div class="link-item"><a href="https://adamismyusername.github.io/4in1/" target="_blank">ğŸ”„ 4in1 Generator</a></div>
            </div>
            <div class="column">
                <h3>Resources</h3>
                <div class="link-item"><a href="https://docs.google.com/document/d/1qHm5vyiJ9SaEAH3HQBoUPX1OO-MQiFwhHKm5m0z-vm0/edit?tab=t.yxuzxgl7ljsq" target="_blank">ğŸ”§ Email Review</a></div>
            </div>
        </div>
    </div>
</div>

<!-- WORKSPACE CARD -->
<div class="flip" data-pattern="slate">
    <div class="front">
        <h1 class="text-shadow">WORKSPACE</h1>
    </div>
    <div class="back back-three-columns layout-grid">
        <div class="columns-wrapper">
            <div class="column">
                <h3>Monday.com</h3>
                <div class="link-item"><a href="https://goldco-force.monday.com/" target="_blank">ğŸ“… Dashboard</a></div>
                <div class="link-item"><a href="https://goldco-force.monday.com/boards/6512821712" target="_blank">ğŸ“„ KAP Contracts</a></div>
                <div class="link-item"><a href="https://goldco-force.monday.com/boards/4489882072/views/201487894" target="_blank">âš–ï¸ In Legal Review</a></div>
            </div>
            <div class="column">
                <h3>Google Docs</h3>
                <div class="link-item"><a href="https://docs.google.com/document/u/0/?tgif=c" target="_blank">ğŸ“ Docs Home</a></div>
                <div class="link-item"><a href="https://docs.google.com/document/d/13mwV4lrk4G2rKMSw40srP9l1jKtYO4Mmft-MJeCS4r8/edit?tab=t.0" target="_blank">ğŸ““ Scratch Pad</a></div>
            </div>
            <div class="column">
                <h3>Google Workspace</h3>
                <div class="link-item" data-modal-id="google-drive"><a href="https://drive.google.com/drive/home" target="_blank">ğŸ’¾ Google Drive</a></div>
                <div class="link-item"><a href="https://mail.google.com/mail/u/0/#inbox" target="_blank">ğŸ“® Gmail</a></div>
                <div class="link-item"><a href="https://docs.google.com/spreadsheets/u/0/?tgif=c" target="_blank">ğŸ“Š Google Sheets</a></div>
            </div>
        </div>
    </div>
</div>

<!-- MY APPS CARD -->
<div class="flip" data-pattern="zinc">
    <div class="front">
        <h1 class="text-shadow">MY APPS</h1>
    </div>
    <div class="back back-three-columns layout-grid">
        <div class="columns-wrapper">
            <div class="column">
                <h3>Calculators</h3>
                <div class="link-item"><a href="https://www.goldcoquiz.com/free-silver-calculator-inline/" target="_blank">ğŸª™ Silver Calc (In)</a></div>
                <div class="link-item"><a href="https://www.goldcoquiz.com/silver-calculator/" target="_blank">ğŸª™ Silver Calc</a></div>
            </div>
            <div class="column">
                <h3>Creative Tools</h3>
                <div class="link-item"><a href="https://adamismyusername.github.io/date-image/" target="_blank">ğŸ“… Date Image</a></div>
            </div>
            <div class="column">
                <h3>Utilities</h3>
                <div class="link-item"><a href="https://adamismyusername.github.io/csveditor/" target="_blank">ğŸ“Š CSV Editor</a></div>
            </div>
        </div>
    </div>
</div>

<!-- COMPETITORS CARD -->
<div class="flip" data-pattern="brown">
    <div class="front">
        <h1 class="text-shadow">COMPETITORS</h1>
    </div>
    <div class="back back-three-columns layout-grid">
        <div class="columns-wrapper">
            <div class="column">
                <h3>Intelligence</h3>
                <div class="link-item"><a href="https://docs.google.com/spreadsheets/d/1JinA_w84g0xk7ACtWpri45MA-W5_C0B28j4Gb7srcWI/edit?gid=2009811899#gid=2009811899" target="_blank">ğŸ” USPs</a></div>
                <div class="link-item"><a href="https://docs.google.com/spreadsheets/d/1if2q4XmGK-f0e1qPWlyOa1vBty-f0s3fCCrqTQhpacg/edit?gid=0#gid=0" target="_blank">ğŸ“‹ Competitor Info</a></div>
            </div>
            <div class="column">
                <h3>Monitoring</h3>
                <div class="link-item"><a href="https://docs.google.com/spreadsheets/d/1zr3OXqT4aGCETYTXR5PaeAimhHgb-RDkxgnd9tTy_x8/edit?gid=0#gid=0" target="_blank">ğŸ”¨ Subject Lines</a></div>
            </div>
            <div class="column">
                <h3>Column 3</h3>
            </div>
        </div>
    </div>
</div>

</div>

<!-- Hamburger Settings Menu -->
<div class="hamburger-menu" id="hamburgerMenu">
    <span></span>
    <span></span>
    <span></span>
</div>

<!-- Settings Panel -->
<div class="settings-panel" id="settingsPanel">
    <div class="settings-header">
        <h3>Settings</h3>
    </div>
    <div class="settings-content">
        <div class="setting-item">
            <label class="toggle-switch">
                <input type="checkbox" id="flipAllToggle">
                <span class="toggle-slider">
                    <span class="toggle-label">Show All Card Backs</span>
                </span>
            </label>
        </div>
    </div>
</div>

<!-- Settings Overlay -->
<div class="settings-overlay" id="settingsOverlay"></div>

<!-- Modal Overlay -->
<div class="modal-overlay" id="modalOverlay"></div>

<!-- Modal Container -->
<div class="modal-container" id="modalContainer">
    <div class="modal-content" id="modalContent">
        <!-- Dynamic content will be inserted here -->
    </div>
</div>

<script>
    // Existing hamburger menu functionality
    const hamburgerMenu = document.getElementById('hamburgerMenu');
    const settingsPanel = document.getElementById('settingsPanel');
    const settingsOverlay = document.getElementById('settingsOverlay');
    const flipAllToggle = document.getElementById('flipAllToggle');
    const flipContainer = document.querySelector('.flip-container');

    // Toggle settings panel
    hamburgerMenu.addEventListener('click', function() {
        hamburgerMenu.classList.toggle('active');
        settingsPanel.classList.toggle('active');
        settingsOverlay.classList.toggle('active');
    });

    // Close settings when clicking overlay
    settingsOverlay.addEventListener('click', function() {
        hamburgerMenu.classList.remove('active');
        settingsPanel.classList.remove('active');
        settingsOverlay.classList.remove('active');
    });

    // Flip all cards toggle
    flipAllToggle.addEventListener('change', function() {
        if (this.checked) {
            flipContainer.classList.add('show-all-backs');
        } else {
            flipContainer.classList.remove('show-all-backs');
        }
    });

    // Load saved state from localStorage
    const savedFlipState = localStorage.getItem('flipAllCards');
    if (savedFlipState === 'true') {
        flipAllToggle.checked = true;
        flipContainer.classList.add('show-all-backs');
    }

    // Save state to localStorage
    flipAllToggle.addEventListener('change', function() {
        localStorage.setItem('flipAllCards', this.checked);
    });

    // ============ MODAL SYSTEM ============

    // Modal data structure with three different interaction types
    const modalData = {
        // 'google-sheets': {  // Commented out - lock-card only version was not ideal
        //     title: 'Google Sheets',
        //     pattern: 'slate', // Uses same pattern as WORKSPACE card
        //     columns: 3,
        //     interactionType: 'lock-card', // Option 1
        //     links: [
        //         { label: 'ğŸ“Š Budget 2025', url: '#' },
        //         { label: 'ğŸ“ˆ Sales Tracker', url: '#' },
        //         { label: 'ğŸ“‰ Analytics Dashboard', url: '#' },
        //         { label: 'ğŸ“Š Marketing Metrics', url: '#' },
        //         { label: 'ğŸ“ˆ KPI Dashboard', url: '#' },
        //         { label: 'ğŸ“‰ Revenue Report', url: '#' }
        //     ]
        // },
        'google-drive': {
            title: 'Google Drive',
            pattern: 'slate',
            columns: 3,
            interactionType: 'hover-with-lock', // New hybrid type
            links: [
                { label: 'ğŸ“ Marketing Assets', url: '#' },
                { label: 'ğŸ“ Sales Materials', url: '#' },
                { label: 'ğŸ“ Design Files', url: '#' },
                { label: 'ğŸ“ Reports', url: '#' },
                { label: 'ğŸ“ Templates', url: '#' },
                { label: 'ğŸ“ Archives', url: '#' }
            ]
        },
        'github': {
            title: 'GitHub Repositories',
            pattern: 'pink',
            columns: 3,
            interactionType: 'click', // Option 3
            links: [
                { label: 'ğŸ”§ Dashboard Project', url: '#' },
                { label: 'ğŸ”§ Generator v1', url: '#' },
                { label: 'ğŸ”§ 4in1 Tool', url: '#' },
                { label: 'ğŸ”§ CSV Editor', url: '#' },
                { label: 'ğŸ”§ Date Image Tool', url: '#' },
                { label: 'ğŸ”§ Utils Library', url: '#' }
            ]
        }
    };

    // Modal elements
    const modalOverlay = document.getElementById('modalOverlay');
    const modalContainer = document.getElementById('modalContainer');
    const modalContent = document.getElementById('modalContent');

    let currentModal = null;
    let currentLockedCard = null;
    let closeTimeout = null;
    let isMouseInModal = false;

    // Function to create modal content
    function createModalContent(data) {
        const columnsClass = `modal-columns-${data.columns || 3}`;

        let linksHTML = data.links.map(link => `
            <div class="modal-link-item">
                <a href="${link.url}" target="_blank">${link.label}</a>
            </div>
        `).join('');

        return `
            <h2>${data.title}</h2>
            <div class="modal-links ${columnsClass}">
                ${linksHTML}
            </div>
        `;
    }

    // Different show modal functions based on interaction type

    // Option 1: Show modal with card lock
    function showModalWithCardLock(modalId, linkItem) {
        // Find the parent card
        const card = linkItem.closest('.flip');

        // Clear any pending close timeout
        if (closeTimeout) {
            clearTimeout(closeTimeout);
            closeTimeout = null;
        }

        // If trying to open the same modal, just keep it open
        if (currentModal === modalId && modalContainer.classList.contains('active')) {
            return;
        }

        // Close any existing modal first
        if (currentModal && currentModal !== modalId) {
            closeModal(true); // Force immediate close
        }

        const data = modalData[modalId];
        if (!data) return;

        currentModal = modalId;

        // Lock the card in flipped state
        if (card) {
            card.classList.add('modal-open-lock');
        }

        // Set the pattern data attribute on modal container
        modalContainer.setAttribute('data-pattern', data.pattern);

        // Create and insert content
        modalContent.innerHTML = createModalContent(data);

        // Show modal with animation
        modalOverlay.classList.add('active');
        modalContainer.classList.add('active');
    }

    // Hybrid Option: Show modal with card lock and independent hover
    function openModalWithLockAndIndependentHover(modalId, linkItem) {
        // Clear any pending close timeout
        if (closeTimeout) {
            clearTimeout(closeTimeout);
            closeTimeout = null;
        }

        // If trying to open the same modal, just keep it open
        if (currentModal === modalId && modalContainer.classList.contains('active')) {
            return;
        }

        // Close any existing modal first
        if (currentModal && currentModal !== modalId) {
            closeModal(true); // Force immediate close
        }

        const data = modalData[modalId];
        if (!data) return;

        currentModal = modalId;

        // Lock the parent card
        const card = linkItem.closest('.flip');
        if (card) {
            card.classList.add('modal-open-lock');
            currentLockedCard = card;
        }

        // Set the pattern data attribute on modal container
        modalContainer.setAttribute('data-pattern', data.pattern);

        // Create and insert content
        modalContent.innerHTML = createModalContent(data);

        // Show modal with animation
        modalOverlay.classList.add('active');
        modalContainer.classList.add('active');

        // Add hover detection to modal itself for hybrid behavior
        // Remove any existing listeners first to prevent duplicates
        modalContainer.removeEventListener('mouseenter', modalMouseEnter);
        modalContainer.removeEventListener('mouseleave', modalMouseLeave);

        // Add fresh listeners for this modal
        modalContainer.addEventListener('mouseenter', modalMouseEnter);
        modalContainer.addEventListener('mouseleave', modalMouseLeave);
    }

    // Modal mouse enter handler
    function modalMouseEnter() {
        clearTimeout(closeTimeout);
        closeTimeout = null;
    }

    // Modal mouse leave handler
    function modalMouseLeave() {
        closeTimeout = setTimeout(() => {
            closeModal();
        }, 300);
    }

    // Option 2: Show modal independently
    function showModalIndependent(modalId) {
        // Clear any pending close timeout
        if (closeTimeout) {
            clearTimeout(closeTimeout);
            closeTimeout = null;
        }

        // If trying to open the same modal, just keep it open
        if (currentModal === modalId && modalContainer.classList.contains('active')) {
            return;
        }

        // Close any existing modal first
        if (currentModal && currentModal !== modalId) {
            closeModal(true); // Force immediate close
        }

        const data = modalData[modalId];
        if (!data) return;

        currentModal = modalId;

        // Set the pattern data attribute on modal container
        modalContainer.setAttribute('data-pattern', data.pattern);

        // Create and insert content
        modalContent.innerHTML = createModalContent(data);

        // Show modal with animation
        modalOverlay.classList.add('active');
        modalContainer.classList.add('active');
    }

    // Option 3: Show modal on click
    function showModalClick(modalId) {
        // Close any existing modal first
        if (currentModal && currentModal !== modalId) {
            closeModal(true); // Force immediate close
        }

        const data = modalData[modalId];
        if (!data) return;

        currentModal = modalId;

        // Set the pattern data attribute on modal container
        modalContainer.setAttribute('data-pattern', data.pattern);

        // Create and insert content
        modalContent.innerHTML = createModalContent(data);

        // Show modal with animation
        modalOverlay.classList.add('active');
        modalContainer.classList.add('active');
    }

    // Function to close modal
    function closeModal(immediate = false) {
        const doClose = () => {
            // Clear any pending close timeout
            if (closeTimeout) {
                clearTimeout(closeTimeout);
                closeTimeout = null;
            }

            // Smart card unlock - check if mouse is still hovering over the locked card
            if (currentLockedCard) {
                // Check if mouse is still hovering over the locked card
                const isHovering = currentLockedCard.matches(':hover');

                if (isHovering) {
                    // Mouse still on card - keep it locked until mouse leaves
                    const unlockOnLeave = () => {
                        currentLockedCard.classList.remove('modal-open-lock');
                        currentLockedCard.removeEventListener('mouseleave', unlockOnLeave);
                        currentLockedCard = null;
                    };
                    currentLockedCard.addEventListener('mouseleave', unlockOnLeave, { once: true });
                } else {
                    // Mouse already left - unlock immediately
                    currentLockedCard.classList.remove('modal-open-lock');
                    currentLockedCard = null;
                }
            }

            // Also remove any other locked cards (fallback cleanup)
            const lockedCard = document.querySelector('.flip.modal-open-lock');
            if (lockedCard && lockedCard !== currentLockedCard) {
                lockedCard.classList.remove('modal-open-lock');
            }

            modalOverlay.classList.remove('active');
            modalContainer.classList.remove('active');
            currentModal = null;

            // Remove modal event listeners
            modalContainer.removeEventListener('mouseenter', modalMouseEnter);
            modalContainer.removeEventListener('mouseleave', modalMouseLeave);

            // Clean up after animation
            setTimeout(() => {
                if (!modalContainer.classList.contains('active')) {
                    modalContent.innerHTML = '';
                    modalContainer.removeAttribute('data-pattern');
                }
            }, 500);
        };

        if (immediate) {
            doClose();
        } else {
            // Add delay to prevent accidental closes
            closeTimeout = setTimeout(doClose, 300);
        }
    }

    // Initialize modal triggers based on interaction type
    function initializeModalTriggers() {
        const linkItems = document.querySelectorAll('[data-modal-id]');

        linkItems.forEach(linkItem => {
            const modalId = linkItem.dataset.modalId;
            const data = modalData[modalId];

            if (!data) return;

            switch(data.interactionType) {
                case 'lock-card':
                    // Option 1: Hover + lock card
                    linkItem.addEventListener('mouseenter', () => {
                        showModalWithCardLock(modalId, linkItem);
                    });

                    linkItem.addEventListener('mouseleave', () => {
                        if (!isMouseInModal) {
                            closeModal();
                        }
                    });

                    // Prevent default link click
                    const link1 = linkItem.querySelector('a');
                    if (link1) {
                        link1.addEventListener('click', (e) => {
                            e.preventDefault();
                        });
                    }
                    break;

                case 'hover-with-lock':
                    // Hybrid option: Hover + lock card + independent modal hover
                    linkItem.addEventListener('mouseenter', () => {
                        openModalWithLockAndIndependentHover(modalId, linkItem);
                    });

                    // Don't tie close to link hover state - modal handles its own hover
                    // The modal will manage closing through its own mouseenter/mouseleave

                    // Prevent default link click
                    const linkHybrid = linkItem.querySelector('a');
                    if (linkHybrid) {
                        linkHybrid.addEventListener('click', (e) => {
                            e.preventDefault();
                        });
                    }
                    break;

                case 'independent':
                    // Option 2: Hover + independent modal
                    linkItem.addEventListener('mouseenter', () => {
                        showModalIndependent(modalId);
                    });

                    // Don't tie close to link hover state for independent modals
                    // Modal will close based on its own hover state

                    // Prevent default link click
                    const link2 = linkItem.querySelector('a');
                    if (link2) {
                        link2.addEventListener('click', (e) => {
                            e.preventDefault();
                        });
                    }
                    break;

                case 'click':
                    // Option 3: Click to open
                    linkItem.addEventListener('click', (e) => {
                        e.preventDefault();
                        showModalClick(modalId);
                    });

                    // Also prevent link click
                    const link3 = linkItem.querySelector('a');
                    if (link3) {
                        link3.addEventListener('click', (e) => {
                            e.preventDefault();
                        });
                    }
                    break;
            }
        });
    }

    // Modal container mouse tracking for non-hybrid modals
    // Note: Hybrid modals (hover-with-lock) handle their own mouse events
    modalContainer.addEventListener('mouseenter', () => {
        isMouseInModal = true;
        // Only handle if not a hybrid modal
        if (currentModal && modalData[currentModal].interactionType !== 'hover-with-lock') {
            // Clear any pending close when mouse enters modal
            if (closeTimeout) {
                clearTimeout(closeTimeout);
                closeTimeout = null;
            }
        }
    });

    modalContainer.addEventListener('mouseleave', () => {
        isMouseInModal = false;
        // Only handle if not a hybrid modal
        if (currentModal && modalData[currentModal].interactionType !== 'hover-with-lock') {
            // Start close timer when mouse leaves modal (300ms delay)
            closeTimeout = setTimeout(() => {
                closeModal(true); // Force immediate close after delay
            }, 300);
        }
    });

    // Close modal on overlay click
    modalOverlay.addEventListener('click', () => {
        closeModal(true);
    });

    // Close modal on ESC key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && currentModal) {
            closeModal(true);
        }
    });

    // Initialize modal triggers
    initializeModalTriggers();

    // Re-attach listeners if flip state changes (in case DOM updates)
    flipAllToggle.addEventListener('change', () => {
        setTimeout(initializeModalTriggers, 100);
    });
</script>

</body>
</html>